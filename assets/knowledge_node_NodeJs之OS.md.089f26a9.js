import{_ as s,o as n,c as a,N as l}from"./chunks/framework.60272d8a.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"knowledge/node/NodeJs之OS.md","lastUpdated":1706686109000}'),p={name:"knowledge/node/NodeJs之OS.md"},o=l(`<h2 id="os" tabindex="-1">os <a class="header-anchor" href="#os" aria-label="Permalink to &quot;os&quot;">​</a></h2><p>Node.js提供了一些基本的底层操作系统的模块OS.</p><h2 id="api" tabindex="-1">api <a class="header-anchor" href="#api" aria-label="Permalink to &quot;api&quot;">​</a></h2><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#BABED8;"> os </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">require</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">os</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[arch] 操作系统CPU架构</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">arch</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[cpus] 每个CPU/内核的信息:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#BABED8;">(os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">cpus</span><span style="color:#BABED8;">()))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[endianness] CPU 的字节序:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">endianness</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[freemem] 操作系统空闲内存量:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">freemem</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[homedir] 当前用户使用的文件夹:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">homedir</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[hostname] 操作系统的主机名:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hostname</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[loadavg] 平均负载:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">loadavg</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[networkInterfaces] 网络接口:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#BABED8;">(os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">networkInterfaces</span><span style="color:#BABED8;">()))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[platform] 操作系统名:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">platform</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[release] 操作系统的发行版本:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">release</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[tmpdir] 操作系统的默认临时文件夹:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tmpdir</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[totalmem] 系统内存总量:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">totalmem</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[type] 操作系统名:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">type</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[uptime] 操作系统运行的时间:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#BABED8;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">uptime</span><span style="color:#BABED8;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">arch</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 操作系统CPU架构x64</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">cpus</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 每个CPU/内核的信息:</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">model</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Intel(R) Core(TM) i5-4200H CPU @ 2.80GHz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">speed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:2794,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">times</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:12349500,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nice</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:0,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:13773515,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">idle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:76721437,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">irq</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:1744218}},{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">model</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Intel(R) Core(TM) i5-4200H CPU @ 2.80GHz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">speed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:2794,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">times</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:12447781,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nice</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:0,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:11801625,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">idle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:78594843,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">irq</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:320156}},{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">model</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Intel(R) Core(TM) i5-4200H CPU @ 2.80GHz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">speed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:2794,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">times</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:13889359,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nice</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:0,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:12343843,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">idle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:76611046,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">irq</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:141578}},{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">model</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Intel(R) Core(TM) i5-4200H CPU @ 2.80GHz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">speed</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:2794,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">times</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:12556328,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">nice</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:0,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sys</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:11338265,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">idle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:78949640,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">irq</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">:128375}}</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">endianness</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> CPU 的字节序:LE</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">freemem</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 操作系统空闲内存量:2904788992</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">homedir</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 当前用户使用的文件夹:C:\\Users\\Administrator</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">hostname</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 操作系统的主机名:SKYUSER-9PEIINO</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">loadavg</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 平均负载:0,0,0</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">networkInterfaces</span><span style="color:#89DDFF;">]</span><span style="color:#BABED8;"> 网络接口:{</span><span style="color:#FFCB6B;">&quot;VMware Network Adapter VMnet1&quot;</span><span style="color:#82AAFF;">:</span><span style="color:#BABED8;">[{&quot;</span><span style="color:#FFCB6B;">address</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">xxxxxxxxxxx</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">netmask</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">ffff:ffff:ffff:ffff::</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">family</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">IPv6</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">mac</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">00:50:56:c0:00:01</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">scopeid</span><span style="color:#FFCB6B;">&quot;:21,&quot;</span><span style="color:#FFCB6B;">internal</span><span style="color:#FFCB6B;">&quot;:false},{&quot;</span><span style="color:#FFCB6B;">address</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">192.168.80.1</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">netmask</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">255.255.255.0</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">family</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">IPv4</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">mac</span><span style="color:#FFCB6B;">&quot;:&quot;</span><span style="color:#FFCB6B;">00:50:56:c0:00:01</span><span style="color:#FFCB6B;">&quot;,&quot;</span><span style="color:#FFCB6B;">internal</span><span style="color:#FFCB6B;">&quot;:false}],&quot;</span><span style="color:#FFCB6B;">VMware</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Network</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Adapter</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">VMnet8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span></span>
<span class="line"><span style="color:#C3E88D;">.......,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">scopeid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:0,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:false},{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">address</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fe80::8cd:96a1:2214:bcfb</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">netmask</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ffff:ffff:ffff:ffff::</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">family</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">IPv6</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mac</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">00:00:00:00:00:00</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">scopeid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:8,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">internal</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">:false}]}</span></span>
<span class="line"><span style="color:#C3E88D;">[platform] 操作系统名:win32</span></span>
<span class="line"><span style="color:#C3E88D;">[release] 操作系统的发行版本:10.0.10240</span></span>
<span class="line"><span style="color:#C3E88D;">[tmpdir] 操作系统的默认临时文件夹:C:\\Users\\ADMINI~1\\AppData\\Local\\Temp</span></span>
<span class="line"><span style="color:#C3E88D;">[totalmem] 系统内存总量:8473526272</span></span>
<span class="line"><span style="color:#C3E88D;">[type] 操作系统名:Windows_NT</span></span>
<span class="line"><span style="color:#C3E88D;">[uptime] 操作系统运行的时间:501123.2912315</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="与操作系统" tabindex="-1">与操作系统 <a class="header-anchor" href="#与操作系统" aria-label="Permalink to &quot;与操作系统&quot;">​</a></h2><p>读了 os 模块的文档，研究了几个有意思的问题：</p><ul><li>识别操作系统平台</li><li>理解和计算“平均负载”</li><li>理解和计算“cpu 使用率”</li><li>理解和计算“内存使用率”</li><li>查看运行时间</li></ul><h3 id="识别操作系统平台" tabindex="-1">识别操作系统平台 <a class="header-anchor" href="#识别操作系统平台" aria-label="Permalink to &quot;识别操作系统平台&quot;">​</a></h3><p>nodejs 提供了os.platform()和os.type()，可以用来识别操作系统平台。推荐使用: os.platform()</p><h3 id="理解和计算-平均负载" tabindex="-1">理解和计算“平均负载” <a class="header-anchor" href="#理解和计算-平均负载" aria-label="Permalink to &quot;理解和计算“平均负载”&quot;">​</a></h3><p>平均负载是指：单位时间内，系统处于可运行状态和不可中断状态的平均进程数。它和 cpu 使用率没有直接关系。</p><p>其中，这里的可运行状态指的是：正在使用 cpu 或正在等待 cpu 的进程。不可中断状态指的是：内核态关键流程中的进程。</p><p>在 nodejs 中，直接调用os.loadavg()可以获得 1、5 和 15 分钟的平均负载，它和 unix 命令uptime返回值一样。</p><p>为什么需要关心平均负载这个问题呢？因为进程分为 2 种，第一种就是“CPU 密集型”，它的 cpu 使用率和平均负载都是高的；第二种是“IO 密集型”，它的 cpu 使用率不一定高，但是等待 IO 会造成平均负载高。所以，cpu 使用率和平均负载共同反应系统性能。</p><p>平均活跃进程数最理想的状态是 cpu 数量=平均负载，如果 cpu 数量 &lt; 平均负载，那么平均负载过高。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">//</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">判断是否平均负载过高</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">isHighLoad</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#FFCB6B;">const</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">cpuNum</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">os.cpus</span><span style="color:#89DDFF;">()</span><span style="color:#C3E88D;">.length</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">os.loadavg</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;">.map</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">item</span><span style="color:#BABED8;"> =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">item</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">cpuNum</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="理解和计算-cpu-使用率" tabindex="-1">理解和计算“cpu 使用率” <a class="header-anchor" href="#理解和计算-cpu-使用率" aria-label="Permalink to &quot;理解和计算“cpu 使用率”&quot;">​</a></h3><p>很多监控软件都提供针对 cpu 使用率的“实时”监控，当然这个实时不是真的实时，有个时间差。这个功能，nodejs 如何实现呢？</p><p>第一步：封装getCPUInfo()，计算获取 cpu 花费的总时间与空闲模式花费的时间。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">/**</span></span>
<span class="line"><span style="color:#89DDFF;">*</span><span style="color:#BABED8;"> 获取cpu花费的总时间与空闲模式的时间</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#FFCB6B;">*/</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">getCPUInfo</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#FFCB6B;">const</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">cpus</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">os.cpus</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#82AAFF;">let</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">user</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#FFCB6B;">nice</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#FFCB6B;">sys</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#FFCB6B;">idle</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#FFCB6B;">irq</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">,</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#FFCB6B;">total</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">  </span><span style="color:#FFCB6B;">cpus.forEach(&lt;span</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-function</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;">&gt;&lt;</span><span style="color:#C3E88D;">span</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-params</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">cpu</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/spa</span><span style="color:#BABED8;">n</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">gt</span><span style="color:#89DDFF;">;&lt;</span><span style="color:#BABED8;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">span</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">const</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/spa</span><span style="color:#BABED8;">n</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">{</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">}</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">cpu</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">user</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times.user</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">nice</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times.nice</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">sys</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times.sys</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">idle</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times.idle</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">irq</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">times.irq</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#BABED8;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">total</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">user</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">nice</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">sys</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">idle</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">+</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">irq</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">return</span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">total,</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">idle</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>第二步：当前时间点 t1，选定一个时间差 intervel，计算 t1 和 t1 + interval 这两个时间点的 cpu 时间差与空闲模式时间差，返回 1 - 空闲时间差 / cpu时间差。返回的结果就是时间差 intervel 内的平均 cpu 使用率。</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">getCPUUsage</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">interval</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#FFCB6B;">const</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">startInfo</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">=</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">getCPUInfo</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">return</span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">new</span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-built_in</span><span style="color:#89DDFF;">&quot;</span><span style="color:#BABED8;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #0086b3; line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;">Promise</span><span style="color:#89DDFF;">&lt;</span><span style="color:#BABED8;">/span</span><span style="color:#89DDFF;">&gt;(&lt;</span><span style="color:#C3E88D;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-function</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&gt;&lt;span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-params</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">resolve</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> =</span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">gt</span><span style="color:#89DDFF;">;&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#FFCB6B;">setTimeout(&lt;span</span><span style="color:#C3E88D;"> class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-function</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&gt;&lt;span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-params</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;()&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> =</span><span style="color:#89DDFF;">&amp;</span><span style="color:#FFCB6B;">gt</span><span style="color:#89DDFF;">;&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#C3E88D;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">span</span><span style="color:#C3E88D;"> class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">const</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> endInfo = getCPUInfo</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#C3E88D;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">span</span><span style="color:#C3E88D;"> class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">const</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> idleDiff = startInfo.idle - endInfo.idle</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C3E88D;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">span</span><span style="color:#C3E88D;"> class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-keyword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #333; font-weight: bold; line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">const</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> totalDiff = startInfo.total - endInfo.total</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C3E88D;">        </span><span style="color:#FFCB6B;">resolve(&lt;span</span><span style="color:#C3E88D;"> class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-number</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #008080; line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;"> - </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">span class=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hljs-built_in</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> style=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">color: #0086b3; line-height: 26px;</span><span style="color:#89DDFF;">&quot;&gt;</span><span style="color:#C3E88D;">Math</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">/span</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">.abs</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">idleDiff</span><span style="color:#C3E88D;"> / totalDiff</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C3E88D;">    </span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">, interval)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">})</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用方式如下：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">getCPUUsage</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;">.then</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">usage</span><span style="color:#BABED8;"> =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">console.log</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">&quot;cpu使用率：&quot;</span><span style="color:#FFCB6B;">,</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">usage</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="理解和计算-内存使用率" tabindex="-1">理解和计算“内存使用率” <a class="header-anchor" href="#理解和计算-内存使用率" aria-label="Permalink to &quot;理解和计算“内存使用率”&quot;">​</a></h3><p>cpu 的指标有平均负载、cpu 使用率，内存的指标有内存使用率。</p><p>借助 nodejs 接口，实现非常简单：</p><div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">getMemUsage</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> 1 - </span><span style="color:#82AAFF;">os.freemem</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> / os.totalmem</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="查看运行时间" tabindex="-1">查看运行时间 <a class="header-anchor" href="#查看运行时间" aria-label="Permalink to &quot;查看运行时间&quot;">​</a></h3><ul><li>nodejs 运行时间：process.uptime()</li><li>系统运行时间：os.uptime()</li></ul>`,33),e=[o];function t(r,c,D,y,F,B){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{i as __pageData,u as default};
